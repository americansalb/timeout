<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Speaking-Test Widget</title>

  <!-- ❶ Load the SDK *deferred* so it’s guaranteed to be parsed before our JS runs -->
  <script src="https://unpkg.com/@elevenlabs/convai-widget-embed" defer></script>
</head>
<body>
  <div id="widget-container" style="max-width:650px;margin:3rem auto;"></div>

  <!-- ❷ Our bootstrap code -->
  <script>
    /**
     * Wait for BOTH:
     *   – the page’s DOMContentLoaded
     *   – the SDK script to create window.ElevenLabsConAI
     */
    function whenSDKReady (cb) {
      const test = () => {
        if (window.ElevenLabsConAI && typeof window.ElevenLabsConAI.mount === 'function') {
          cb();
        } else {
          requestAnimationFrame(test);
        }
      };
      test();
    }

    document.addEventListener('DOMContentLoaded', () => {
      whenSDKReady(() => {
        console.log('✅ SDK detected, mounting widget…');

        window.ElevenLabsConAI.mount(
          {
            agentId: 'agent_01jz3mzxkkfw09832nvhjtxqyy',

            /* ❸ Register the pause tool right here */
            clientTools: {
              PAUSE_5_Second: async () => {
                console.log('↪ calling /pause …');
                await fetch('https://timeout-ri84.onrender.com/pause', { method: 'POST' });
                console.log('✅ PAUSE_5_Second finished');
                return {};
              }
            },

            /* optional visual tweaks */
            theme: 'light'
          },
          document.getElementById('widget-container')
        );
      });
    });
  </script>
</body>
</html>
