<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>English Speaking Test Client</title>
  <!-- Load the ElevenLabs Conversational AI SDK -->
  <script src="https://unpkg.com/@elevenlabs/conversational-ai@latest/dist/elevenlabs-conversational-ai.umd.js"></script>
</head>
<body>
  <!-- Container for the widget -->
  <div id="widget" style="width: 600px; margin: auto;"></div>

  <script>
    (async () => {
      // Destructure SDK components
      const { ElevenLabsClient, Conversation, ClientTools, VoiceWidget } = window.ElevenLabsConAI;

      // 1) Initialize the ElevenLabs client
      const client = new ElevenLabsClient({
        apiKey: "sk_23eb1e7d3a84719ec50e4da7b4f4124c113b56b03209d65d"
      });

      // 2) Create ClientTools and register the pause handler
      const tools = new ClientTools();
      tools.register("PAUSE_5_Second", async () => {
        await fetch("https://timeout-ri84.onrender.com/pause", { method: "POST" });
        console.log("Pause tool called");
        return {};
      });

      console.log("PAUSE_5_Second registered:", tools.has("PAUSE_5_Second"));

      // 3) Instantiate and start the conversation with the VoiceWidget UI
      const conversation = new Conversation({
        client,
        agentId: "agent_01jz3mzxkkfw09832nvhjtxqyy",
        clientTools: tools,
        ui: { container: "#widget", widget: VoiceWidget }
      });

      conversation.start();
    })();
  </script>
</body>
</html>
